<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NewRobotCode/WPILIBC(v2022.3.1): frc::DifferentialDrivePoseEstimator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ORION.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NewRobotCode/WPILIBC(v2022.3.1)
   &#160;<span id="projectnumber">v2022.0.0.28</span>
   </div>
   <div id="projectbrief">FRC 2022 Robot Code for Team #7464 - ORION</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classfrc_1_1_differential_drive_pose_estimator.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classfrc_1_1_differential_drive_pose_estimator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">frc::DifferentialDrivePoseEstimator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_differential_drive_pose_estimator_8h_source.html">DifferentialDrivePoseEstimator.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af2b98ce90290615914b78dfcbc5d4b60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#af2b98ce90290615914b78dfcbc5d4b60">DifferentialDrivePoseEstimator</a> (const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;gyroAngle, const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;initialPose, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 5 &gt; &amp;stateStdDevs, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;localMeasurementStdDevs, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;visionMeasurementStdDevs, units::second_t nominalDt=0.02_s)</td></tr>
<tr class="separator:af2b98ce90290615914b78dfcbc5d4b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0efe2ff468e8161f0075a5507d29622"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#aa0efe2ff468e8161f0075a5507d29622">SetVisionMeasurementStdDevs</a> (const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;visionMeasurementStdDevs)</td></tr>
<tr class="separator:aa0efe2ff468e8161f0075a5507d29622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46215f68f5537854d6171585440476f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#ac46215f68f5537854d6171585440476f">ResetPosition</a> (const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;pose, const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;gyroAngle)</td></tr>
<tr class="separator:ac46215f68f5537854d6171585440476f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0832593d3d75e4078aa0c7a1e52d18f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#aa0832593d3d75e4078aa0c7a1e52d18f">GetEstimatedPosition</a> () const</td></tr>
<tr class="separator:aa0832593d3d75e4078aa0c7a1e52d18f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa09ba511b592ed6115d67e57a2ff38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a8aa09ba511b592ed6115d67e57a2ff38">AddVisionMeasurement</a> (const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;visionRobotPose, units::second_t timestamp)</td></tr>
<tr class="separator:a8aa09ba511b592ed6115d67e57a2ff38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad273aa27bda035fe8ca417a7ea2891c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#ad273aa27bda035fe8ca417a7ea2891c5">AddVisionMeasurement</a> (const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;visionRobotPose, units::second_t timestamp, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;visionMeasurementStdDevs)</td></tr>
<tr class="separator:ad273aa27bda035fe8ca417a7ea2891c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0486775dc01622c00b9f941849f45158"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a0486775dc01622c00b9f941849f45158">Update</a> (const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;gyroAngle, const <a class="el" href="structfrc_1_1_differential_drive_wheel_speeds.html">DifferentialDriveWheelSpeeds</a> &amp;wheelSpeeds, units::meter_t leftDistance, units::meter_t rightDistance)</td></tr>
<tr class="separator:a0486775dc01622c00b9f941849f45158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193af76e798abf24e69f0c8377dbd801"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a193af76e798abf24e69f0c8377dbd801">UpdateWithTime</a> (units::second_t currentTime, const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;gyroAngle, const <a class="el" href="structfrc_1_1_differential_drive_wheel_speeds.html">DifferentialDriveWheelSpeeds</a> &amp;wheelSpeeds, units::meter_t leftDistance, units::meter_t rightDistance)</td></tr>
<tr class="separator:a193af76e798abf24e69f0c8377dbd801"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a7cf0799f38b2fd7d017a9f194aa4039c"><td class="memTemplParams" colspan="2"><a id="a7cf0799f38b2fd7d017a9f194aa4039c"></a>
template&lt;int Dim&gt; </td></tr>
<tr class="memitem:a7cf0799f38b2fd7d017a9f194aa4039c"><td class="memTemplItemLeft" align="right" valign="top">static <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, Dim &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>StdDevMatrixToArray</b> (const Eigen::Vector&lt; double, Dim &gt; &amp;stdDevs)</td></tr>
<tr class="separator:a7cf0799f38b2fd7d017a9f194aa4039c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39c906370aaa4800bd54a77bdb4cbd8"><td class="memItemLeft" align="right" valign="top"><a id="aa39c906370aaa4800bd54a77bdb4cbd8"></a>
static Eigen::Vector&lt; double, 5 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>F</b> (const Eigen::Vector&lt; double, 5 &gt; &amp;x, const Eigen::Vector&lt; double, 3 &gt; &amp;u)</td></tr>
<tr class="separator:aa39c906370aaa4800bd54a77bdb4cbd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af25870673c37179fd8f8a019e087c560"><td class="memItemLeft" align="right" valign="top"><a id="af25870673c37179fd8f8a019e087c560"></a>
static Eigen::Vector&lt; double, 5 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>FillStateVector</b> (const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;pose, units::meter_t leftDistance, units::meter_t rightDistance)</td></tr>
<tr class="separator:af25870673c37179fd8f8a019e087c560"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a9a340db62397b170aa1d2f120a8f98bd"><td class="memItemLeft" align="right" valign="top"><a id="a9a340db62397b170aa1d2f120a8f98bd"></a>
<a class="el" href="classfrc_1_1_unscented_kalman_filter.html">UnscentedKalmanFilter</a>&lt; 5, 3, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_observer</b></td></tr>
<tr class="separator:a9a340db62397b170aa1d2f120a8f98bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07ccec91cfa02c68a267ccfc0596e7fd"><td class="memItemLeft" align="right" valign="top"><a id="a07ccec91cfa02c68a267ccfc0596e7fd"></a>
<a class="el" href="classfrc_1_1_kalman_filter_latency_compensator.html">KalmanFilterLatencyCompensator</a>&lt; 5, 3, 3, <a class="el" href="classfrc_1_1_unscented_kalman_filter.html">UnscentedKalmanFilter</a>&lt; 5, 3, 3 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_latencyCompensator</b></td></tr>
<tr class="separator:a07ccec91cfa02c68a267ccfc0596e7fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0515d3da111161b113947d6cf48b8527"><td class="memItemLeft" align="right" valign="top"><a id="a0515d3da111161b113947d6cf48b8527"></a>
std::function&lt; void(const Eigen::Vector&lt; double, 3 &gt; &amp;u, const Eigen::Vector&lt; double, 3 &gt; &amp;y)&gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_visionCorrect</b></td></tr>
<tr class="separator:a0515d3da111161b113947d6cf48b8527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a379f73402611ce24701dc99e2d220"><td class="memItemLeft" align="right" valign="top"><a id="ae1a379f73402611ce24701dc99e2d220"></a>
<a class="el" href="class_eigen_1_1_matrix.html">Eigen::Matrix</a>&lt; double, 3, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_visionContR</b></td></tr>
<tr class="separator:ae1a379f73402611ce24701dc99e2d220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d0a2b23477cfff2c5628baf2040525"><td class="memItemLeft" align="right" valign="top"><a id="aa5d0a2b23477cfff2c5628baf2040525"></a>
units::second_t&#160;</td><td class="memItemRight" valign="bottom"><b>m_nominalDt</b></td></tr>
<tr class="separator:aa5d0a2b23477cfff2c5628baf2040525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f3188c2fa06052ebd45c4b7f91de99a"><td class="memItemLeft" align="right" valign="top"><a id="a5f3188c2fa06052ebd45c4b7f91de99a"></a>
units::second_t&#160;</td><td class="memItemRight" valign="bottom"><b>m_prevTime</b> = -1_s</td></tr>
<tr class="separator:a5f3188c2fa06052ebd45c4b7f91de99a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac19e7bfbcf44879b393c7b29c820bd1f"><td class="memItemLeft" align="right" valign="top"><a id="ac19e7bfbcf44879b393c7b29c820bd1f"></a>
<a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a>&#160;</td><td class="memItemRight" valign="bottom"><b>m_gyroOffset</b></td></tr>
<tr class="separator:ac19e7bfbcf44879b393c7b29c820bd1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4b8f9a5d85dd1143715f04dedc19a2"><td class="memItemLeft" align="right" valign="top"><a id="a2f4b8f9a5d85dd1143715f04dedc19a2"></a>
<a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a>&#160;</td><td class="memItemRight" valign="bottom"><b>m_previousAngle</b></td></tr>
<tr class="separator:a2f4b8f9a5d85dd1143715f04dedc19a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class wraps an Unscented Kalman Filter to fuse latency-compensated vision measurements with differential drive encoder measurements. It will correct for noisy vision measurements and encoder drift. It is intended to be an easy drop-in for <a class="el" href="classfrc_1_1_differential_drive_odometry.html">DifferentialDriveOdometry</a>. In fact, if you never call <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a8aa09ba511b592ed6115d67e57a2ff38">AddVisionMeasurement()</a>, and only call <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a0486775dc01622c00b9f941849f45158">Update()</a>, this will behave exactly the same as <a class="el" href="classfrc_1_1_differential_drive_odometry.html">DifferentialDriveOdometry</a>.</p>
<p><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a0486775dc01622c00b9f941849f45158">Update()</a> should be called every robot loop (if your robot loops are faster or slower than the default, then you should change the nominal delta time via the constructor).</p>
<p><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a8aa09ba511b592ed6115d67e57a2ff38">AddVisionMeasurement()</a> can be called as infrequently as you want; if you never call it, then this class will behave like regular encoder odometry.</p>
<p>The state-space system used internally has the following states (x), inputs (u), and outputs (y):</p>
<p><b> x = [x, y, theta, dist_l, dist_r]ᵀ </b> in the field coordinate system containing x position, y position, heading, left encoder distance, and right encoder distance.</p>
<p><b> u = [v_x, v_y, omega]ᵀ </b> containing x velocity, y velocity, and angular velocity in the field coordinate system.</p>
<p>NB: Using velocities make things considerably easier, because it means that teams don't have to worry about getting an accurate model. Basically, we suspect that it's easier for teams to get good encoder data than it is for them to perform system identification well enough to get a good model.</p>
<p><b> y = [x, y, theta]ᵀ </b> from vision containing x position, y position, and heading; or <b>y = [dist_l, dist_r, theta] </b> containing left encoder position, right encoder position, and gyro heading. </p>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8h_source.html#l00053">53</a> of file <a class="el" href="_differential_drive_pose_estimator_8h_source.html">DifferentialDrivePoseEstimator.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af2b98ce90290615914b78dfcbc5d4b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2b98ce90290615914b78dfcbc5d4b60">&#9670;&nbsp;</a></span>DifferentialDrivePoseEstimator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DifferentialDrivePoseEstimator::DifferentialDrivePoseEstimator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;&#160;</td>
          <td class="paramname"><em>gyroAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;&#160;</td>
          <td class="paramname"><em>initialPose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 5 &gt; &amp;&#160;</td>
          <td class="paramname"><em>stateStdDevs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>localMeasurementStdDevs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>visionMeasurementStdDevs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::second_t&#160;</td>
          <td class="paramname"><em>nominalDt</em> = <code>0.02_s</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructs a <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html">DifferentialDrivePoseEstimator</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gyroAngle</td><td>The gyro angle of the robot. </td></tr>
    <tr><td class="paramname">initialPose</td><td>The estimated initial pose. </td></tr>
    <tr><td class="paramname">stateStdDevs</td><td>Standard deviations of model states. Increase these numbers to trust your model's state estimates less. This matrix is in the form [x, y, theta, dist_l, dist_r]ᵀ, with units in meters and radians. </td></tr>
    <tr><td class="paramname">localMeasurementStdDevs</td><td>Standard deviations of the encoder and gyro measurements. Increase these numbers to trust sensor readings from encoders and gyros less. This matrix is in the form [dist_l, dist_r, theta]ᵀ, with units in meters and radians. </td></tr>
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision measurements. Increase these numbers to trust global measurements from vision less. This matrix is in the form [x, y, theta]ᵀ, with units in meters and radians. </td></tr>
    <tr><td class="paramname">nominalDt</td><td>The period of the loop calling <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a0486775dc01622c00b9f941849f45158">Update()</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html#l00014">14</a> of file <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html">DifferentialDrivePoseEstimator.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8aa09ba511b592ed6115d67e57a2ff38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aa09ba511b592ed6115d67e57a2ff38">&#9670;&nbsp;</a></span>AddVisionMeasurement() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DifferentialDrivePoseEstimator::AddVisionMeasurement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;&#160;</td>
          <td class="paramname"><em>visionRobotPose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::second_t&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a vision measurement to the Unscented Kalman Filter. This will correct the odometry pose estimate while still accounting for measurement noise.</p>
<p>This method can be called as infrequently as you want, as long as you are calling <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a0486775dc01622c00b9f941849f45158">Update()</a> every loop.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionRobotPose</td><td>The pose of the robot as measured by the vision camera. </td></tr>
    <tr><td class="paramname">timestamp</td><td>The timestamp of the vision measurement in seconds. Note that if you don't use your own time source by calling <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a193af76e798abf24e69f0c8377dbd801">UpdateWithTime()</a>, then you must use a timestamp with an epoch since FPGA startup (i.e. the epoch of this timestamp is the same epoch as <a class="el" href="classfrc_1_1_timer.html#a3cad5587d0c587d2e979aa2b5cdf9a60">frc::Timer::GetFPGATimestamp()</a>. This means that you should use <a class="el" href="classfrc_1_1_timer.html#a3cad5587d0c587d2e979aa2b5cdf9a60">frc::Timer::GetFPGATimestamp()</a> as your time source in this case. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html#l00073">73</a> of file <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html">DifferentialDrivePoseEstimator.cpp</a>.</p>

</div>
</div>
<a id="ad273aa27bda035fe8ca417a7ea2891c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad273aa27bda035fe8ca417a7ea2891c5">&#9670;&nbsp;</a></span>AddVisionMeasurement() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void frc::DifferentialDrivePoseEstimator::AddVisionMeasurement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;&#160;</td>
          <td class="paramname"><em>visionRobotPose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::second_t&#160;</td>
          <td class="paramname"><em>timestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>visionMeasurementStdDevs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adds a vision measurement to the Unscented Kalman Filter. This will correct the odometry pose estimate while still accounting for measurement noise.</p>
<p>This method can be called as infrequently as you want, as long as you are calling <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a0486775dc01622c00b9f941849f45158">Update()</a> every loop.</p>
<p>Note that the vision measurement standard deviations passed into this method will continue to apply to future measurements until a subsequent call to <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#aa0efe2ff468e8161f0075a5507d29622">SetVisionMeasurementStdDevs()</a> or this method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionRobotPose</td><td>The pose of the robot as measured by the vision camera. </td></tr>
    <tr><td class="paramname">timestamp</td><td>The timestamp of the vision measurement in seconds. Note that if you don't use your own time source by calling <a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html#a193af76e798abf24e69f0c8377dbd801">UpdateWithTime()</a>, then you must use a timestamp with an epoch since FPGA startup (i.e. the epoch of this timestamp is the same epoch as <a class="el" href="classfrc_1_1_timer.html#a3cad5587d0c587d2e979aa2b5cdf9a60">frc::Timer::GetFPGATimestamp()</a>. This means that you should use <a class="el" href="classfrc_1_1_timer.html#a3cad5587d0c587d2e979aa2b5cdf9a60">frc::Timer::GetFPGATimestamp()</a> as your time source in this case. </td></tr>
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision measurements. Increase these numbers to trust global measurements from vision less. This matrix is in the form [x, y, theta]ᵀ, with units in meters and radians. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8h_source.html#l00175">175</a> of file <a class="el" href="_differential_drive_pose_estimator_8h_source.html">DifferentialDrivePoseEstimator.h</a>.</p>

</div>
</div>
<a id="aa0832593d3d75e4078aa0c7a1e52d18f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0832593d3d75e4078aa0c7a1e52d18f">&#9670;&nbsp;</a></span>GetEstimatedPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> DifferentialDrivePoseEstimator::GetEstimatedPosition </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the pose of the robot at the current time as estimated by the Unscented Kalman Filter.</p>
<dl class="section return"><dt>Returns</dt><dd>The estimated robot pose. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html#l00067">67</a> of file <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html">DifferentialDrivePoseEstimator.cpp</a>.</p>

</div>
</div>
<a id="ac46215f68f5537854d6171585440476f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46215f68f5537854d6171585440476f">&#9670;&nbsp;</a></span>ResetPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DifferentialDrivePoseEstimator::ResetPosition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;&#160;</td>
          <td class="paramname"><em>pose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;&#160;</td>
          <td class="paramname"><em>gyroAngle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resets the robot's position on the field.</p>
<p>You NEED to reset your encoders to zero when calling this method. The gyroscope angle does not need to be reset here on the user's robot code. The library automatically takes care of offsetting the gyro angle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pose</td><td>The estimated pose of the robot on the field. </td></tr>
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html#l00055">55</a> of file <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html">DifferentialDrivePoseEstimator.cpp</a>.</p>

</div>
</div>
<a id="aa0efe2ff468e8161f0075a5507d29622"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0efe2ff468e8161f0075a5507d29622">&#9670;&nbsp;</a></span>SetVisionMeasurementStdDevs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DifferentialDrivePoseEstimator::SetVisionMeasurementStdDevs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>visionMeasurementStdDevs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the pose estimator's trust of global measurements. This might be used to change trust in vision measurements after the autonomous period, or to change trust as distance to a vision target increases.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision measurements. Increase these numbers to trust global measurements from vision less. This matrix is in the form [x, y, theta]ᵀ, with units in meters and radians. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html#l00049">49</a> of file <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html">DifferentialDrivePoseEstimator.cpp</a>.</p>

</div>
</div>
<a id="a0486775dc01622c00b9f941849f45158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0486775dc01622c00b9f941849f45158">&#9670;&nbsp;</a></span>Update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> DifferentialDrivePoseEstimator::Update </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;&#160;</td>
          <td class="paramname"><em>gyroAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfrc_1_1_differential_drive_wheel_speeds.html">DifferentialDriveWheelSpeeds</a> &amp;&#160;</td>
          <td class="paramname"><em>wheelSpeeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::meter_t&#160;</td>
          <td class="paramname"><em>leftDistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::meter_t&#160;</td>
          <td class="paramname"><em>rightDistance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the Unscented Kalman Filter using only wheel encoder information. Note that this should be called every loop iteration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
    <tr><td class="paramname">wheelSpeeds</td><td>The velocities of the wheels in meters per second. </td></tr>
    <tr><td class="paramname">leftDistance</td><td>The distance traveled by the left encoder. </td></tr>
    <tr><td class="paramname">rightDistance</td><td>The distance traveled by the right encoder.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The estimated pose of the robot. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html#l00080">80</a> of file <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html">DifferentialDrivePoseEstimator.cpp</a>.</p>

</div>
</div>
<a id="a193af76e798abf24e69f0c8377dbd801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a193af76e798abf24e69f0c8377dbd801">&#9670;&nbsp;</a></span>UpdateWithTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> DifferentialDrivePoseEstimator::UpdateWithTime </td>
          <td>(</td>
          <td class="paramtype">units::second_t&#160;</td>
          <td class="paramname"><em>currentTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;&#160;</td>
          <td class="paramname"><em>gyroAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfrc_1_1_differential_drive_wheel_speeds.html">DifferentialDriveWheelSpeeds</a> &amp;&#160;</td>
          <td class="paramname"><em>wheelSpeeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::meter_t&#160;</td>
          <td class="paramname"><em>leftDistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::meter_t&#160;</td>
          <td class="paramname"><em>rightDistance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the Unscented Kalman Filter using only wheel encoder information. Note that this should be called every loop iteration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">currentTime</td><td>The time at which this method was called. </td></tr>
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
    <tr><td class="paramname">wheelSpeeds</td><td>The velocities of the wheels in meters per second. </td></tr>
    <tr><td class="paramname">leftDistance</td><td>The distance traveled by the left encoder. </td></tr>
    <tr><td class="paramname">rightDistance</td><td>The distance traveled by the right encoder.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The estimated pose of the robot. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html#l00088">88</a> of file <a class="el" href="_differential_drive_pose_estimator_8cpp_source.html">DifferentialDrivePoseEstimator.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>C:/ORION2023/allwpilib/wpimath/src/main/native/include/frc/estimator/<a class="el" href="_differential_drive_pose_estimator_8h_source.html">DifferentialDrivePoseEstimator.h</a></li>
<li>C:/ORION2023/allwpilib/wpimath/src/main/native/cpp/estimator/<a class="el" href="_differential_drive_pose_estimator_8cpp_source.html">DifferentialDrivePoseEstimator.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>frc</b></li><li class="navelem"><a class="el" href="classfrc_1_1_differential_drive_pose_estimator.html">DifferentialDrivePoseEstimator</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
